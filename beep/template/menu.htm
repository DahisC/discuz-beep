<div class="bbda pbm mbm" style="padding: 0 10px;">
  <p>
    <strong>è«–å£‡å—¶å•µé¼ å¯ä»¥é€ééŸ³æ•ˆä»¥åŠæ¨™é¡Œé–ƒçˆæ•ˆæœå³æ™‚æé†’ä½ æœ‰æ–°è¨Šæ¯ã€‚</strong>
  </p>
  <br />
  <p>
    æ­¤æ’ä»¶é‚„åœ¨é€²è¡Œæ¸¬è©¦ä¸­ï¼Œè‹¥æœ‰æœªè‡»å®Œå–„ä¹‹è™•æˆ–æ”¹é€²å»ºè­°è«‹è‡³
    <a href="http://www.bluecg.net/forum-46-1.html" target="_blank">
      éŠæˆ²å»ºè­°å€
    </a>
    å›å ±ï¼Œè¬è¬ï¼
  </p>
</div>

<!-- <hr style="margin: 10px 0;" /> -->

<div id="beep_form" class="beep_wrapper">
  <div class="beep_row">
    <div>
      <p><strong>å—¶å•µé¼ æé†’åŠŸèƒ½</strong></p>
      <p>å•¾</p>
    </div>
    <div>
      <input name="beep_disabled" type="radio" value="0" />é–‹å•Ÿ<br />
      <input name="beep_disabled" type="radio" value="1" />é—œé–‰
    </div>
  </div>
  <!--  -->
  <div class="beep_row">
    <div>
      <p><strong>é™åˆ¶æé†’æ¬¡æ•¸</strong></p>
    </div>
    <div>
      <input name="beep_limited" type="radio" value="1" />é™åˆ¶<br />
      <input name="beep_limited" type="radio" value="0" checked />ä¸é™åˆ¶
    </div>
  </div>
  <!--  -->
  <div class="beep_row">
    <div>
      <p><strong>æé†’æ¬¡æ•¸ä¸Šé™</strong></p>
      <p>
        åœ¨é™åˆ¶æé†’æ¬¡æ•¸çš„æƒ…æ³ä¸‹ï¼Œæ¯æ¬¡åœç•™æ–¼é é¢æ™‚çš„æé†’æ¬¡æ•¸ã€‚
      </p>
      <p><small>â€»é‡æ–°æ•´ç†æˆ–è½‰æ›é é¢æ™‚æœƒé‡æ–°è¨ˆç®—ã€‚</small></p>
    </div>
    <div class="centered">
      <input name="beep_frequency" type="number" placeholder="0" value="3" />
    </div>
  </div>
  <!--  -->
  <div class="beep_row">
    <div>
      <p><strong>æé†’éŸ³æ•ˆ</strong></p>
      <p>æŒ‰ä¸‹ ğŸµ å¯ä»¥è©¦è½éŸ³æ•ˆ</p>
    </div>
    <div>
      <input name="beep_sound" type="radio" value="mailing" checked />
      éƒµä»¶æŠµé” <a href="#" onclick="beep_playSound(event, 'mailing')">ğŸµ</a
      ><br />
      <input name="beep_sound" type="radio" value="stealing" />
      å·ç«ŠæˆåŠŸ <a href="#" onclick="beep_playSound(event, 'stealing')">ğŸµ</a
      ><br />
      <input name="beep_sound" type="radio" value="beep" />
      è£œè¡€é­”æ³• <a href="#" onclick="beep_playSound(event, 'beep')">ğŸµ</a><br />
      <input name="beep_sound" type="radio" value="recovering" />
      æ¢å¾©é­”æ³• <a href="#" onclick="beep_playSound(event, 'recovering')">ğŸµ</a
      ><br />
    </div>
  </div>
  <!-- Submit -->
  <button id="beep_submit" class="pn pnc" onclick="beep_submit()">
    <strong>å„²å­˜è¨­å®š</strong>
  </button>
</div>

<script>
  if ("$beep_settings['uid']" !== "") {
    beep_initSettings(); // å¦‚æœä½¿ç”¨è€…å·²è¨­å®šå‰‡èˆ‡è³‡æ–™åº«é€£æ¥ï¼Œåˆå§‹åŒ–è¨­ç½®é¸å–®
  }

  function beep_initSettings() {
    // å—¶å•µé¼ æé†’åŠŸèƒ½
    const radioDisabled = document.querySelectorAll(
      'input[name="beep_disabled"]'
    );

    radioDisabled.forEach((e) => {
      '$beep_settings["disabled"]' == e.value
        ? (e.checked = true)
        : (e.checked = false);
    });

    // é™åˆ¶æé†’æ¬¡æ•¸
    const radioLimited = document.querySelectorAll(
      'input[name="beep_limited"]'
    );

    radioLimited.forEach((e) => {
      '$beep_settings["limited"]' == e.value
        ? (e.checked = true)
        : (e.checked = false);
    });

    // æé†’éŸ³æ•ˆ
    const radioSound = document.querySelectorAll('input[name="beep_sound"]');

    radioSound.forEach((e) => {
      '$beep_settings["sound"]' == e.value
        ? (e.checked = true)
        : (e.checked = false);
    });

    // æé†’æ¬¡æ•¸ä¸Šé™
    const inputFrequency = document.querySelector(
      'input[name="beep_frequency"]'
    );
    inputFrequency.value = '$beep_settings["frequency"]';
  }

  function beep_playSound(e, soundName) {
    e.preventDefault();
    const sound_url =
      "https://raw.githubusercontent.com/DahisC/test/master/" +
      soundName +
      ".mp3";
    const beep_sound = new Audio(sound_url);
    beep_sound.play();
  }

  function beep_submit() {
    const disabled = document.querySelector(
      'input[name="beep_disabled"]:checked'
    ).value;
    const limited = document.querySelector('input[name="beep_limited"]:checked')
      .value;
    const frequency = document.querySelector('input[name="beep_frequency"]')
      .value;
    const sound = document.querySelector('input[name="beep_sound"]:checked')
      .value;

    //

    const payload = JSON.stringify({
      disabled,
      limited,
      frequency,
      sound,
    });

    const ajax = new XMLHttpRequest();
    ajax.open("POST", "plugin.php?id=beep:setting");
    ajax.setRequestHeader("Content-Type", "application/json");
    ajax.send(payload);

    setTimeout(() => {
      window.location.reload();
    }, 1000);
  }
</script>

<style>
  .beep_wrapper {
    display: flex;
    flex-direction: column;
    font-size: 1em;
    font-family: Microsoft JhengHei;
  }

  .beep_row {
    display: flex;
    flex-direction: row;
    margin: 10px 0px;
  }

  .beep_row > div:nth-child(1) {
    min-width: 150px;
    max-width: 150px;
    display: flex;
    flex-direction: column;
    align-items: left;
    justify-content: top;
  }

  .beep_wrapper div {
    padding: 5px;
    min-height: 50px;
  }

  .beep_wrapper input[type="number"] {
    width: 50%;
  }

  .beep_wrapper input[type="radio"] {
    vertical-align: text-bottom;
  }

  .beep_wrapper .centered {
    display: flex;
    justify-content: left;
    align-items: center;
  }

  .beep_wrapper button#beep_submit {
    width: fit-content;
    margin-left: 10px;
  }
</style>
